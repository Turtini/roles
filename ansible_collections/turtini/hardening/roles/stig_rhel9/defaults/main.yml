---
# Default behavior is SAFE:
# - audit-only (no changes) unless explicitly enabled
# - allow running on RHEL only, unless rebuilds are explicitly allowed

# Execution mode (choose exactly one)
turtini_stig_apply: false
turtini_stig_audit_only: true

# Allow RHEL-compatible rebuilds (Rocky/Alma/Oracle/CentOS Stream, etc.)
# Note: even when allowed, this role is still scoped to major version 9.
turtini_stig_allow_rebuilds: false

# Print preflight summary details
turtini_stig_preflight_verbose: true

# Recognized distributions for friendly gating/messaging
turtini_stig_supported_distributions:
  - RedHat
  - Rocky
  - AlmaLinux
  - OracleLinux
  - CentOS

# Safety toggles / patterns we’ll use as we add controls
# These allow “opt-in” for higher-impact changes without making the role scary.
turtini_stig_allow_reboot: false
turtini_stig_allow_service_restart: true

# Tagging / control selection patterns (future-friendly)
# When true, we’ll allow selecting subsets of controls by category/tag.
turtini_stig_enable_control_selection: false

# Control selection (optional)
turtini_stig_controls_include: []
turtini_stig_controls_exclude: []
turtini_stig_tags_include: []
turtini_stig_tags_exclude: []
turtini_stig_categories_include: []
turtini_stig_categories_exclude: []

# Password aging targets (login.defs)
# Defaults chosen to be common compliance baselines; adjust per customer policy.
turtini_stig_pass_max_days: 60
turtini_stig_pass_min_days: 1
turtini_stig_pass_warn_age: 7

# Account lockout targets (pam_faillock via /etc/security/faillock.conf)
turtini_stig_faillock_deny: 3
turtini_stig_faillock_fail_interval: 900   # seconds
turtini_stig_faillock_unlock_time: 0       # 0 = requires admin unlock; set to 900 for 15 min
turtini_stig_faillock_even_deny_root: true

# Inactive account disable targets (/etc/default/useradd)
# INACTIVE = number of days after password expires until the account is disabled
# -1 means never disable; 35 is a common compliance baseline.
turtini_stig_useradd_inactive_days: 35

# Password complexity targets (pwquality)
turtini_stig_pwquality_minlen: 15
turtini_stig_pwquality_minclass: 4
turtini_stig_pwquality_dcredit: -1
turtini_stig_pwquality_ucredit: -1
turtini_stig_pwquality_lcredit: -1
turtini_stig_pwquality_ocredit: -1

# SSH hardening targets (sshd drop-in via /etc/ssh/sshd_config.d)
# Safe-by-default: in apply mode we will WRITE the drop-in, but only RELOAD sshd if service restarts are allowed.
turtini_stig_ssh_dropin_path: "/etc/ssh/sshd_config.d/90-turtini-stig-hardening.conf"

# Common STIG-ish baselines (adjust per customer policy)
turtini_stig_ssh_permit_root_login: "no"
turtini_stig_ssh_permit_empty_passwords: "no"
turtini_stig_ssh_password_authentication: "no"     # NOTE: change to "yes" if agency uses passwords
turtini_stig_ssh_kbd_interactive_auth: "no"
turtini_stig_ssh_gssapi_authentication: "no"       # NOTE: set "yes" if agency uses Kerberos/GSSAPI
turtini_stig_ssh_x11_forwarding: "no"
turtini_stig_ssh_max_auth_tries: 3
turtini_stig_ssh_login_grace_time: 60              # seconds
turtini_stig_ssh_client_alive_interval: 900        # seconds
turtini_stig_ssh_client_alive_count_max: 0         # 0 = disconnect after interval

# Removable media mount restrictions
# Filesystems commonly used for removable media
turtini_stig_removable_fs_types:
  - vfat
  - exfat
  - ntfs
  - iso9660
  - udf

# Required mount options for removable media (when applicable)
turtini_stig_removable_mount_required_options:
  - nodev
  - nosuid
  - noexec

