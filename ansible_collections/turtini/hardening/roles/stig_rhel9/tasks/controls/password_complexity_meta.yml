---
# Control: Password complexity (pwquality)
# Configured via /etc/security/pwquality.conf on RHEL 9

- name: "Control Metadata | password-complexity"
  ansible.builtin.set_fact:
    turtini_control_meta:
      id: "password-complexity"
      title: "Password complexity is enforced using pwquality"
      stig:
        rules: []   # TODO: map to exact RHEL 9 STIG Rule / Vuln IDs
      severity: "medium"
      cci:
        - "TBD"
      nist:
        - "IA-5"
      rationale: >-
        Enforcing password complexity reduces the likelihood of successful
        brute-force and credential-guessing attacks.
      check: >-
        Review /etc/security/pwquality.conf and confirm minlen, minclass, and
        credit settings meet the site policy.
      fix: >-
        Configure pwquality parameters in /etc/security/pwquality.conf to match
        the site policy.
      implementation: >-
        This control audits current pwquality settings and, when apply mode is
        enabled, enforces minimum length and character class requirements.
      notes:
        - "This control relies on authselect-managed PAM configuration."
        - "Applies to new password changes."
  tags: [controls, auth, password-complexity, meta]

- name: "Password Complexity | Metadata (verbose)"
  ansible.builtin.debug:
    var: turtini_control_meta
  when: turtini_stig_preflight_verbose | bool
  tags: [controls, auth, password-complexity, meta]
